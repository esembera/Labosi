VJ1 EQU FFFF1000
VJ2 EQU FFFF2000
VJ2_BS EQU FFFF2004
VJ3 EQU FFFF3000
VJ3_BS EQU FFFF3004
VJ3_ISDONE EQU FFFF3008
VJ3_STOP EQU FFFF300C

	ORG 0
	MOVE 10000, SP
	JP GLAVNI
	
	ORG 8
	DW 100
	
GLAVNI
	MOVE %B 10000, SR
	MOVE 1, R0
	STORE R0, (VJ3_STOP)

UVJETNA
	LOAD R1, (VJ2_BS)
	OR R1,R1,R1
	JP_NZ UVJ1
	JP UVJETNA

UVJ1
	LOAD R0, (BROJ)
	LOAD R1, (COUNTER)
	ADD R1, 1, R1
	STORE R1, (COUNTER)
	STORE R0, (VJ2)
	STORE R0,(VJ2_BS)
	JP UVJETNA

	ORG 100
	PUSH R0
	MOVE SR, R0
	PUSH R0
	STORE R0, (VJ3_BS)
	LOAD R0, (VJ1)
	OR R0,R0,R0
	JP_N KRAJ
	PUSH R0
	CALL OBRADI
	STORE R0, (BROJ)
	LOAD R0, (COUNTER)
	STORE R0, (VJ3)
	ADD SP, 4, SP
	POP R0
	MOVE R0, SR
	POP R0
	STORE R0, (VJ3_ISDONE)
	RETI

OBRADI
	PUSH R1
	MOVE %D 2, R0
	LOAD R1, (SP+8)
	SUB R1, 1, R1
	SHL R0, R1, R0
	POP R1
	RET
	
KRAJ
	MOVE 0, R0
	STORE R0, (VJ3_STOP)
	HALT
	
	
	

BROJ DW 0
COUNTER DW 0