    ORG 0
	MOV R13, #81<8
    B GLAVNI
    ORG 18
    B PREKIDNI
	
GLAVNI
	MRS R0, CPSR
	BIC R0, R0, #80
    MSR CPSR_C, R0
    LDR R1, RTC
    MOV R2, #1<8
    STR R2, [R1, #4]
    MOV R2, #1
    STR R2, [R1, #10]
    MOV R0, #0D
    BL LCDWR
LOOP
	B LOOP


GPIO DW 0FFFFFF00
RTC DW 0FFFFFE00
INDEX DW 0
    ORG 400
    DB 49,6e,74,65,72,6e,61,74,69,6f,6e,61,6c,69,73,61,74,69,6f,6e,0  

PREKIDNI
    STMFD R13!, {R0, R1, R2, R3, R4, R14}
	LDR R1, INDEX
	LDR R2, GPIO
    LDR R3, RTC
	MOV R4, #4<8
	LDR R0, [R1, R4]
	CMP R0, #0
    BEQ NULA
	
    STR R0, [R3, #8]
    MOV R0, #0
    STR R0, [R3, #0C] 
    MOV R0, #0D
    BL LCDWR
    MOV R0, #3E
    BL LCDWR
    BL LCDWR
    BL LCDWR
	LDR R0, [R1, R4]
    BL LCDWR
    MOV R0, #3C
    BL LCDWR
    BL LCDWR
    BL LCDWR
    MOV R0, #0A
    BL LCDWR
    ADD R1, R1, #1
    STR R1, INDEX
KRAJ
	LDMFD R13!, {R0, R1, R2, R3, R4, R14} 
    SUBS PC, R14, #4 
NULA
    MOV R0, #0
    STR R0, INDEX
	B KRAJ

LCDWR
    AND R0, R0, #7F
    STRB R0, [R2, #4]
    ORR R0, R0, #80
    STRB R0, [R2, #4]
    AND R0, R0, #7F
    STRB R0, [R2, #4]
    MOV PC, LR
